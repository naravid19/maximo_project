{% extends 'maximo_app/base.html' %}
{% comment %} path: maximo_project\maximo_app\templates\upload.html {% endcomment %}
{% load static %}
{% load widget_tweaks %}
{% block title %}Upload Files{% endblock %}
{% block style %}
<style>
    .form-container {
        max-width: 640px;
        margin: 12px auto;
        background-color: #fff;
    }
    .form-title {
        font-size: 1.75rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <select> */
    select:focus {
        background-color: #fff;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å */
    select option:checked {
        background-color: #e5e7eb;
    }
    
    /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á dropdown*/
    select {
        font-size: 16px;
        font-weight: 400;
    }
    
    /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô dropdown */
    select option {
        font-size: 16px;
        font-weight: 400;
        line-height: 32px;
    }

    .error-container {
        padding: 15px;
        color: #fff;
        border-radius: 8px;
        max-width: 100%;
        margin: 10px auto;
        font-family: "Bai Jamjuree", sans-serif;
    }
    
    .error-title {
        font-size: 18px;
        font-weight: bold;
        text-decoration: underline;
        margin-bottom: 10px;
    }
    
    .error-details {
        list-style-type: disc;
        margin-left: 40px;
        margin-top: 10px;
    }

    .error-description {
        margin-left: -20px;
    }
    
    .error-note {
        margin-top: 20px;
        font-size: 14px;
        color: #fff;
    }
    
    /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å (‡∏à‡∏ô‡∏ñ‡∏∂‡∏á 479px) */
    @media (max-width: 479px) {
        .error-container {
            padding: 10px;
            font-size: 14px;
        }
    
        .error-title {
            font-size: 16px;
        }
    
        .error-details {
            margin-left: 20px;
        }
    
        .error-note {
            font-size: 12px;
        }
    }
    
    /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ (480px - 767px) */
    @media (min-width: 480px) and (max-width: 767px) {
        .error-container {
            padding: 10px;
            font-size: 16px;
        }
    
        .error-title {
            font-size: 18px;
        }
    
        .error-details {
            margin-left: 30px;
        }
    
        .error-note {
            font-size: 13px;
        }
    }
    
    /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏•‡πá‡∏ï‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô (768px ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) */
    @media (min-width: 768px) {
        .error-container {
            max-width: 600px;
            padding: 15px;
        }
    
        .error-title {
            font-size: 20px;
        }
    
        .error-details {
            margin-left: 40px;
        }
    
        .error-note {
            font-size: 14px;
        }
    }
    {% comment %} 
        max-width: 640px;           max-w-screen-sm
        margin: 12px auto;          my-3 mx-auto
        background-color: #fff;     bg-white
        - max-w-screen-sm my-3 mx-auto bg-white

        font-size: 1.75rem;         text-[1.75rem]
        font-weight: 600;           font-semibold
        margin-bottom: 1.5rem;      mb-6
        - text-[1.75rem] font-semibold mb-6
        - text-4xl font-semibold mb-6

        - px-6 pt-[1.375rem] pb-4

        font-light	font-weight: 300;
        font-normal	font-weight: 400;
        font-medium	font-weight: 500;

        text-sm	    font-size: 0.875rem; /* 14px */
                    line-height: 1.25rem; /* 20px */
        text-base	font-size: 1rem; /* 16px */
                    line-height: 1.5rem; /* 24px */
        text-lg	    font-size: 1.125rem; /* 18px */
                    line-height: 1.75rem; /* 28px */
        
    {% endcomment %}
</style>
{% endblock %}

{% block content %}

    {% if messages %}
        {% for message in messages %}
        
            <div class="flex justify-center w-full">
                <div id="alert-{{ forloop.counter }}" class="flex items-center w-full max-w-screen-sm p-4 mt-2 mb-4 text-white bg-red-600 rounded-lg shadow-md dark:bg-red-700 dark:text-white" role="alert">
                    <svg class="flex-shrink-0 w-4 h-4 mr-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                    </svg>
                    <span class="sr-only">Info</span>
                    <div class="text-base font-medium">
                        {{ message|safe }} <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error ‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏à‡∏≤‡∏Å messages -->
                    </div>
                    <button type="button" class="ml-auto -mx-1.5 -my-1.5 bg-transparent text-white rounded-lg focus:ring-2 focus:ring-red-300 p-1.5 hover:bg-red-500 hover:text-white inline-flex items-center justify-center h-8 w-8 dark:hover:bg-red-600" onclick="this.parentElement.remove();" aria-label="Close">
                        <span class="sr-only">Close</span>
                        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                        </svg>
                    </button>
                </div>
            </div>
        
        {% endfor %}
    {% endif %}

    <ol class="relative flex items-center justify-center max-w-screen-sm px-6 py-4 mx-auto my-4 space-x-4 text-sm font-medium text-center text-gray-500 bg-white border border-gray-200 rounded-lg shadow-sm dark:text-gray-400 sm:text-base dark:bg-gray-800 dark:border-gray-700 rtl:space-x-reverse">
        <li class="flex items-center {% if not schedule_filename and not location_filename and not 'download_link_comment' in request.session or error_messages and schedule_filename and location_filename and 'download_link_comment' in request.session or not error_messages and not 'download_link_job_plan_task' in request.session and not 'download_link_job_plan_labor' in request.session and not 'download_link_pm_plan' in request.session and not 'download_link_template' in request.session and schedule_filename and location_filename and 'download_link_comment' in request.session or 'download_link_job_plan_task' in request.session or 'download_link_job_plan_labor' in request.session or 'download_link_pm_plan' in request.session or 'download_link_template' in request.session %}text-blue-600 dark:text-blue-500{% endif %}">
            <span class="flex items-center justify-center w-5 h-5 text-xs border {% if not schedule_filename and not location_filename and not 'download_link_comment' in request.session or error_messages and schedule_filename and location_filename and 'download_link_comment' in request.session or not error_messages and not 'download_link_job_plan_task' in request.session and not 'download_link_job_plan_labor' in request.session and not 'download_link_pm_plan' in request.session and not 'download_link_template' in request.session and schedule_filename and location_filename and 'download_link_comment' in request.session or 'download_link_job_plan_task' in request.session or 'download_link_job_plan_labor' in request.session or 'download_link_pm_plan' in request.session or 'download_link_template' in request.session %}border-blue-600{% else %}border-gray-500 dark:border-gray-400{% endif %} rounded-full me-2 shrink-0">
                1
            </span>
            <span data-tooltip-target="step-1" class="ms-2 cursor-help">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î<span class="hidden sm:inline">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span></span>
            <svg class="w-3 h-3 ms-2 sm:ms-4 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 10">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 9 4-4-4-4M1 9l4-4-4-4"/>
            </svg>
        </li>
        <li class="flex items-center {% if error_messages and schedule_filename and location_filename and 'download_link_comment' in request.session or not error_messages and not 'download_link_job_plan_task' in request.session and not 'download_link_job_plan_labor' in request.session and not 'download_link_pm_plan' in request.session and not 'download_link_template' in request.session and schedule_filename and location_filename and 'download_link_comment' in request.session or 'download_link_job_plan_task' in request.session or 'download_link_job_plan_labor' in request.session or 'download_link_pm_plan' in request.session or 'download_link_template' in request.session %}text-blue-600 dark:text-blue-500{% endif %}">
            <span class="flex items-center justify-center w-5 h-5 text-xs border {% if error_messages and schedule_filename and location_filename and 'download_link_comment' in request.session or not error_messages and not 'download_link_job_plan_task' in request.session and not 'download_link_job_plan_labor' in request.session and not 'download_link_pm_plan' in request.session and not 'download_link_template' in request.session and schedule_filename and location_filename and 'download_link_comment' in request.session or 'download_link_job_plan_task' in request.session or 'download_link_job_plan_labor' in request.session or 'download_link_pm_plan' in request.session or 'download_link_template' in request.session %}border-blue-600 dark:border-blue-500{% else %}border-gray-500 dark:border-gray-400{% endif %} rounded-full me-2 shrink-0">
                2
            </span>
            <span data-tooltip-target="step-2" class="ms-2 cursor-help">‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•<span class="hidden sm:inline"></span></span>
            <svg class="w-3 h-3 ms-2 sm:ms-4 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 10">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 9 4-4-4-4M1 9l4-4-4-4"/>
            </svg>
        </li>
        <li class="flex items-center {% if not error_messages and not 'download_link_job_plan_task' in request.session and not 'download_link_job_plan_labor' in request.session and not 'download_link_pm_plan' in request.session and not 'download_link_template' in request.session and schedule_filename and location_filename and 'download_link_comment' in request.session or 'download_link_job_plan_task' in request.session or 'download_link_job_plan_labor' in request.session or 'download_link_pm_plan' in request.session or 'download_link_template' in request.session %}text-blue-600 dark:text-blue-500{% endif %}">
            <span class="flex items-center justify-center w-5 h-5 text-xs border {% if not error_messages and not 'download_link_job_plan_task' in request.session and not 'download_link_job_plan_labor' in request.session and not 'download_link_pm_plan' in request.session and not 'download_link_template' in request.session and schedule_filename and location_filename and 'download_link_comment' in request.session or 'download_link_job_plan_task' in request.session or 'download_link_job_plan_labor' in request.session or 'download_link_pm_plan' in request.session or 'download_link_template' in request.session %}border-blue-600 dark:border-blue-500{% else %}border-gray-500 dark:border-gray-400{% endif %} rounded-full me-2 shrink-0">
                3
            </span>
            <span data-tooltip-target="step-3" class="ms-2 cursor-help">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà<span class="hidden sm:inline"></span></span>
            <svg class="w-3 h-3 ms-2 sm:ms-4 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 10">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 9 4-4-4-4M1 9l4-4-4-4"/>
            </svg>
        </li>
        <li class="flex items-center {% if 'download_link_job_plan_task' in request.session or 'download_link_job_plan_labor' in request.session or 'download_link_pm_plan' in request.session or 'download_link_template' in request.session %}text-blue-600 dark:text-blue-500{% endif %}">
            <span class="flex items-center justify-center w-5 h-5 text-xs border {% if 'download_link_job_plan_task' in request.session or 'download_link_job_plan_labor' in request.session or 'download_link_pm_plan' in request.session or 'download_link_template' in request.session %}border-blue-600 dark:border-blue-500{% else %}border-gray-500 dark:border-gray-400{% endif %} rounded-full me-2 shrink-0">
                4
            </span>
            <span data-tooltip-target="step-4" class="cursor-help">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î<span class="hidden sm:inline"></span></span>
        </li>
    </ol>

    <div id="step-1" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700">
        ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Final Schedule, Location File
        <div class="tooltip-arrow" data-popper-arrow></div>
    </div>
    <div id="step-2" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700">
        ‡∏´‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠
        <div class="tooltip-arrow" data-popper-arrow></div>
    </div>
    <div id="step-3" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700">
        ‡∏Å‡∏≥‡∏´‡∏ô‡∏î Plant Unit ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô Unit ‡∏´‡∏£‡∏∑‡∏≠ Common (‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î Business area ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢)
        <div class="tooltip-arrow" data-popper-arrow></div>
    </div>
    <div id="step-4" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700">
        ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Job Plan Labor, Job Plan Task, PM Plan, Template MxLoader JB-PM Plan
        <div class="tooltip-arrow" data-popper-arrow></div>
    </div>
    
    {% if not schedule_filename and not location_filename and not 'download_link_comment' in request.session %}
        <div class="container relative px-6 pt-[1.375rem] pb-4 max-w-screen-sm mx-auto my-4 bg-white rounded-md shadow-sm">
            {% comment %} <div class="absolute top-0 left-0 w-full h-2 bg-[rgb(63,81,181)] rounded-t-md"></div> {% endcomment %}
        
            <h1 class="mb-4 text-3xl font-medium tracking-wide text-gray-800">
                ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÅ‡∏ö‡∏ö‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡∏≤‡∏°‡∏ß‡∏≤‡∏£‡∏∞‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå üöÄ
            </h1>
            <p class="mb-4 text-base font-medium text-gray-600">FOR IBM MAXIMO</p>
        
            <!-- Content box -->
            <div class="flex flex-col gap-4 px-6 pt-3 pb-4 mt-4 bg-white border border-gray-200 rounded-lg">
            {% comment %} <div class="flex flex-col gap-3 px-6 pt-2 pb-3 mt-3 border-t border-gray-200"> {% endcomment %}
                <!-- Template PO-Schedule Section -->
                <div class="flex items-center justify-between pb-2 border-b border-dashed">
                    <p class="text-base font-normal text-gray-700">
                        üìö ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
                    </p>
                    <a href="#" class="flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 4v12m0 0l-3-3m3 3l3-3"/><path d="M5 20h14"/></svg>
                        DOWNLOAD
                    </a>
                </div>
                
                <div class="flex items-center justify-between pb-2 border-b border-dashed">
                    <p class="text-base font-normal text-gray-700">
                        üìÑ FINAL SCHEDULE(BLANK)
                    </p>
                    <a href="{% url 'download_schedule' %}" class="flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 4v12m0 0l-3-3m3 3l3-3"/><path d="M5 20h14"/></svg>
                        DOWNLOAD
                    </a>
                </div>
                
                <div class="flex items-center justify-between pb-2 border-b border-dashed">
                    <p class="text-base font-normal text-gray-700">
                        üìÑ TEMPLATE MXLOADER JB-PM PLAN(BLANK)
                    </p>
                    <a href="{% url 'download_original_template' %}" class="flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 4v12m0 0l-3-3m3 3l3-3"/><path d="M5 20h14"/></svg>
                        DOWNLOAD
                    </a>
                </div>

                <div class="flex items-center justify-between pb-2 border-b border-dashed">
                    <p class="text-base font-normal text-gray-700">
                        üìä FINAL SCHEDULE(EXAMPLE)
                    </p>
                    <a href="{% url 'download_example_schedule' %}" class="flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 4v12m0 0l-3-3m3 3l3-3"/><path d="M5 20h14"/></svg>
                        DOWNLOAD
                    </a>
                </div>

                <div class="flex items-center justify-between">
                    <p class="text-base font-normal text-gray-700">
                        üìä TEMPLATE MXLOADER JB-PM PLAN(EXAMPLE)
                    </p>
                    <a href="{% url 'download_example_template' %}" class="flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 4v12m0 0l-3-3m3 3l3-3"/><path d="M5 20h14"/></svg>
                        DOWNLOAD
                    </a>
                </div>
            </div>

            <!-- Required question notice -->
            <p class="px-6 mt-3 text-sm font-normal text-red-600">
                * ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
            </p>
        </div>
    

        <div class="container relative px-6 pt-[1.375rem] pb-4 max-w-screen-sm mx-auto my-4 bg-white rounded-md shadow-sm">
            <form id="uploadForm" novalidate method="post" enctype="multipart/form-data" class="space-y-6" onsubmit="validateUploadForm(event)">
                {% csrf_token %}

                <!-- Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ -->
                <div class="sm:col-span-3">
                    <label for="year" class="block text-base font-medium leading-6 text-gray-900">
                        {{ form.year.label }}
                        {% if form.year.field.required %}
                            <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                        {% endif %}
                    </label>
                    <div class="mt-2">
                        {{ form.year|add_class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6" }}
                    </div>
                    {% if form.year.errors %}
                    <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                        <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Error:</span> 
                            {% for error in form.year.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </div>

                <!-- Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà -->
                <div class="sm:col-span-3">
                    <label for="frequency" class="block text-base font-medium leading-6 text-gray-900">
                        {{ form.frequency.label }} (Years)
                        {% if form.frequency.field.required %}
                            <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                        {% endif %}
                    </label>
                    <div class="mt-2">
                        {{ form.frequency|add_class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6" }}
                    </div>
                    {% if form.frequency.errors %}
                    <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                        <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Error:</span> 
                            {% for error in form.frequency.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </div>

                <!-- Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Plant Type -->
                <div class="sm:col-span-3">
                    <label for="plant_type" class="block text-base font-medium leading-6 text-gray-900">
                        {{ form.plant_type.label }}
                        {% if form.plant_type.field.required %}
                            <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                        {% endif %}
                    </label>
                    <div class="mt-2">
                        {{ form.plant_type|add_class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6" }}
                    </div>
                    {% if form.plant_type.errors %}
                    <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                        <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Error:</span> 
                            {% for error in form.plant_type.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    <p id="plant_type_description" class="mt-1 text-sm text-gray-500"></p>
                </div>

                <!-- Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Site -->
                <div class="sm:col-span-3">
                    <label for="site" class="block text-base font-medium leading-6 text-gray-900">
                        {{ form.site.label }}
                        {% if form.site.field.required %}
                            <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                        {% endif %}
                    </label>
                    <div class="mt-2">
                        {{ form.site|add_class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6" }}
                    </div>
                    {% if form.site.errors %}
                    <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                        <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Error:</span> 
                            {% for error in form.site.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    <p id="site_description" class="mt-1 text-sm text-gray-500"></p>
                </div>

                <!-- Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Child Site -->
                <div class="sm:col-span-3">
                    <label for="child_site" class="block text-base font-medium leading-6 text-gray-900">
                        {{ form.child_site.label }}
                        {% if form.child_site.field.required %}
                            <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                        {% endif %}
                    </label>
                    <div class="mt-2">
                        {{ form.child_site|add_class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6" }}
                    </div>
                    {% if form.child_site.errors %}
                    <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                        <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Error:</span> 
                            {% for error in form.child_site.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    <p id="child_site_description" class="mt-1 text-sm text-gray-500"></p>
                </div>

                <!-- Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Unit -->
                <div class="sm:col-span-3">
                    <label for="unit" class="block text-base font-medium leading-6 text-gray-900">
                        {{ form.unit.label }}
                        {% if form.unit.field.required %}
                            <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                        {% endif %}
                    </label>
                    <div class="mt-2">
                        {{ form.unit|add_class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6" }}
                    </div>
                    {% if form.unit.errors %}
                    <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                        <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Error:</span> 
                            {% for error in form.unit.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </div>

                <!-- Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å WO Status -->
                <div class="sm:col-span-3">
                    <label for="wostatus" class="block text-base font-medium leading-6 text-gray-900">
                        {{ form.wostatus.label }}
                        {% if form.wostatus.field.required %}
                            <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                        {% endif %}
                    </label>
                    <div class="mt-2">
                        {{ form.wostatus|add_class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6" }}
                    </div>
                    {% if form.wostatus.errors %}
                    <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                        <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Error:</span> 
                            {% for error in form.wostatus.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    <p id="wostatus_description" class="mt-1 text-sm text-gray-500"></p>
                </div>

                <!-- Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Work Type -->
                <div class="sm:col-span-3">
                    <label for="work_type" class="block text-base font-medium leading-6 text-gray-900">
                        {{ form.work_type.label }}
                        {% if form.work_type.field.required %}
                            <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                        {% endif %}
                    </label>
                    <div class="mt-2">
                        {{ form.work_type|add_class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6" }}
                    </div>
                    {% if form.work_type.errors %}
                    <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                        <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Error:</span> 
                            {% for error in form.work_type.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    <p id="work_type_description" class="mt-1 text-sm text-gray-500"></p>
                </div>
                
                <!-- Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ACTTYPE -->
                <div class="sm:col-span-3">
                    <label for="{{ form.acttype.id_for_label }}" class="block text-base font-medium leading-6 text-gray-900">
                        {{ form.acttype.label }}
                        {% if form.acttype.field.required %}
                            <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                        {% endif %}
                    </label>
                    <div class="mt-2">
                        {{ form.acttype|add_class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6" }}
                    </div>
                    {% if form.acttype.errors %}
                    <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                        <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Error:</span> 
                            {% for error in form.acttype.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    <p id="acttype_description" class="mt-1 text-sm text-gray-500"></p>
                </div>

                <!-- Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å WBS -->
                <div class="sm:col-span-3">
                    <label for="wbs" class="block text-base font-medium leading-6 text-gray-900">
                        {{ form.wbs.label }}
                        {% if form.wbs.field.required %}
                            <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                        {% endif %}
                    </label>
                    <div class="mt-2">
                        {{ form.wbs|add_class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6" }}
                    </div>
                    {% if form.wbs.errors %}
                    <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                        <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Error:</span> 
                            {% for error in form.wbs.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    <p id="wbs_description" class="mt-1 text-sm text-gray-500"></p>
                </div>
                
                <!-- ‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Project ID Other -->
                <div class="hidden sm:col-span-3" id="other_projectid_outer_container">
                    <div class="flex items-center space-x-4 ">
                        <label for="projectid_other" class="block text-base font-medium leading-6 text-gray-900">
                            {{ form.projectid_other.label }}:
                            {% if form.projectid_other.field.required %}
                                <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                            {% endif %}
                        </label>
                        <div class="relative flex items-center flex-1" id="other_projectid_inner_container">
                            <span id="other_projectid_signal" class="absolute hidden w-3 h-3 bg-green-500 rounded-full shadow-md top-3 right-3"></span>
                            <input type="text" id="other_projectid" name="projectid_other" class="block rounded-t-lg px-2.5 pb-2.5 pt-5 w-full text-sm text-gray-900 bg-gray-50 dark:bg-gray-700 border-0 border-b-2 border-gray-300 dark:border-gray-600 appearance-none dark:text-white dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600 peer" placeholder="" disabled />
                            <label id="label_other_projectid" for="other_projectid" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-4 z-10 origin-[0] start-2.5 peer-focus:text-green-600 peer-focus:dark:text-green-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-4">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ PROJECTID ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡∏ö‡∏ô‡∏£‡∏∞‡∏ö‡∏ö MMS ‡πÄ‡∏ä‡πà‡∏ô O-CHNC21-67CI</label>
                            
                            {% if form.projectid_other.errors %}
                            <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                                <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                                </svg>
                                <span class="sr-only">Error</span>
                                <div>
                                    <span class="font-medium">Error:</span>
                                    {% for error in form.projectid_other.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- ‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö WBS Other -->
                <div class="hidden sm:col-span-3" id="other_wbs_outer_container">
                    <div class="flex items-center space-x-4 ">
                        <label for="wbs_other" class="block text-base font-medium leading-6 text-gray-900">
                            {{ form.wbs_other.label }}:
                            {% if form.wbs_other.field.required %}
                                <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                            {% endif %}
                        </label>
                        <div class="relative flex items-center flex-1" id="other_wbs_inner_container">
                            <!-- ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á input -->
                            <span id="other_wbs_signal" class="absolute hidden w-3 h-3 bg-green-500 rounded-full shadow-md top-3 right-3"></span>
                            <input type="text" id="other_wbs" name="wbs_other" class="block rounded-t-lg px-2.5 pb-2.5 pt-5 w-full text-sm text-gray-900 bg-gray-50 dark:bg-gray-700 border-0 border-b-2 border-gray-300 dark:border-gray-600 appearance-none dark:text-white dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600 peer" placeholder="" disabled />
                            <label id="label_other_wbs" for="other_wbs" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-4 z-10 origin-[0] start-2.5 peer-focus:text-green-600 peer-focus:dark:text-green-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-4">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ SUBWBS ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡∏ö‡∏ô‡∏£‡∏∞‡∏ö‡∏ö MMS ‡πÄ‡∏ä‡πà‡∏ô O-CHNC21-67CI-LTSA</label>
                            
                            {% if form.wbs_other.errors %}
                            <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                                <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                                </svg>
                                <span class="sr-only">Error</span>
                                <div>
                                    <span class="font-medium">Error:</span>
                                    {% for error in form.wbs_other.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        const wbsField = document.getElementById('id_wbs');
                        const otherWbsInput = document.getElementById('other_wbs');
                        const labelOtherWbs = document.getElementById('label_other_wbs');
                        const otherWbsSignal = document.getElementById('other_wbs_signal');
                        const otherWbsOuterContainer = document.getElementById('other_wbs_outer_container');

                        const otherProjectIdInput = document.getElementById('other_projectid');
                        const labelOtherProjectId = document.getElementById('label_other_projectid');
                        const otherProjectIdSignal = document.getElementById('other_projectid_signal');
                        const otherProjectIdOuterContainer = document.getElementById('other_projectid_outer_container');

                        function toggleOtherWbsField() {
                            if (wbsField.value === '6') {
                                otherWbsInput.disabled = false; // ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ü‡∏¥‡∏•‡∏î‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "other"
                                otherWbsInput.placeholder = '';
                                otherWbsInput.style.borderBottomColor = '#16a34a';  // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á input ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
                                labelOtherWbs.style.color = '#16a34a';  // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° label ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
                                otherWbsSignal.classList.remove('hidden');  // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì
                                otherWbsOuterContainer.classList.remove('hidden');

                                otherProjectIdInput.disabled = false;
                                otherProjectIdInput.placeholder = '';
                                otherProjectIdInput.style.borderBottomColor = '#16a34a';
                                labelOtherProjectId.style.color = '#16a34a';
                                otherProjectIdSignal.classList.remove('hidden');
                                otherProjectIdOuterContainer.classList.remove('hidden');
                            } else {
                                otherWbsInput.disabled = true;
                                otherWbsInput.placeholder = '';
                                otherWbsInput.style.borderBottomColor = '';  // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏µ‡∏Ç‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                                otherWbsInput.value = '';  // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å
                                labelOtherWbs.style.color = '';  // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏µ label ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                                otherWbsSignal.classList.add('hidden');  // ‡∏ã‡πà‡∏≠‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì
                                otherWbsOuterContainer.classList.add('hidden');

                                otherProjectIdInput.disabled = true;
                                otherProjectIdInput.placeholder = '';
                                otherProjectIdInput.style.borderBottomColor = '';
                                otherProjectIdInput.value = '';
                                labelOtherProjectId.style.color = '';
                                otherProjectIdSignal.classList.add('hidden');
                                otherProjectIdOuterContainer.classList.add('hidden');
                            }
                        }
                    
                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                        toggleOtherWbsField();
                    
                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÉ‡∏ô‡∏ü‡∏¥‡∏•‡∏î‡πå `wbs`
                        wbsField.addEventListener('change', toggleOtherWbsField);
                    });
                    
                </script>
                
                <div class="sm:col-span-3">
                    <label for="grouping_options" class="block text-base font-medium leading-6 text-gray-900">
                        Grouping
                        {% if form.fields.selected_order.required %}
                            <span class="text-base font-normal text-red-600" style="position: relative; top: 1px;">*</span>
                        {% endif %}
                    </label>
                
                    <!-- No arrange group Checkbox -->
                    <div class="flex items-center mt-2">
                        <input id="no-arrange-checkbox" name="grouping_options" type="checkbox" value="no_arrange" onclick="handleCheckboxSelection(this)"
                            class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                        <label for="no-arrange-checkbox" class="text-sm font-medium text-gray-900 ms-2 dark:text-gray-300">No arrange group</label>
                    </div>
                
                    <!-- Arrange group Checkbox -->
                    <div class="flex items-center mt-2">
                        <input id="arrange-group-checkbox" type="checkbox" onclick="toggleArrangeOptions(this)"
                            class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                        <label for="arrange-group-checkbox" class="text-sm font-medium text-gray-900 ms-2 dark:text-gray-300">Arrange group</label>
                    </div>
                    <p id="helper-checkbox-text" class="mt-1 text-sm font-normal text-gray-500 dark:text-gray-300">
                        ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏° Work Order ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                    </p>
                
                    <!-- Arrange group child checkboxes (‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô) -->
                    <div id="arrange-options" class="hidden mt-2 ml-6">
                        <div class="flex items-center me-4">
                            <input id="system-checkbox" name="grouping_options" type="checkbox" value="SYSTEM" onclick="handleCheckboxSelection(this)"
                                class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                            <label for="system-checkbox" class="text-sm font-medium text-gray-900 ms-2 dark:text-gray-300">System</label>
                        </div>
                        <div class="flex items-center me-4">
                            <input id="craft-checkbox" name="grouping_options" type="checkbox" value="EGCRAFT" onclick="handleCheckboxSelection(this)"
                                class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                            <label for="craft-checkbox" class="text-sm font-medium text-gray-900 ms-2 dark:text-gray-300">Craft</label>
                        </div>
                        <div class="flex items-center me-4">
                            <input id="permit-checkbox" name="grouping_options" type="checkbox" value="PTW" onclick="handleCheckboxSelection(this)"
                                class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                            <label for="permit-checkbox" class="text-sm font-medium text-gray-900 ms-2 dark:text-gray-300">Permit Type</label>
                        </div>
                        <div class="flex items-center me-4">
                            <input id="start-date-checkbox" name="grouping_options" type="checkbox" value="NEXTDATE" onclick="handleCheckboxSelection(this)"
                                class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                            <label for="start-date-checkbox" class="text-sm font-medium text-gray-900 ms-2 dark:text-gray-300">Start Date</label>
                        </div>
                    </div>
                
                    <!-- Hidden input ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å -->
                    <input type="hidden" name="selected_order" id="selected_order_input" value="{{ selected_order|join:',' }}">
                
                    {% if form.selected_order.errors %}
                    <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                        <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Error:</span> 
                            {% for error in form.selected_order.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </div>
                
                <script>
                    // Array ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                    const selectedOrder = [];
                
                    function toggleArrangeOptions(checkbox) {
                        const noArrangeCheckbox = document.getElementById('no-arrange-checkbox');
                        const arrangeOptions = document.getElementById('arrange-options');
                
                        if (checkbox.checked) {
                            arrangeOptions.classList.remove('hidden');
                            noArrangeCheckbox.checked = false;
                            const index = selectedOrder.indexOf('no_arrange');
                            if (index > -1) selectedOrder.splice(index, 1);
                        } else {
                            arrangeOptions.classList.add('hidden');
                            document.querySelectorAll('#arrange-options input[type="checkbox"]').forEach(childCheckbox => {
                                childCheckbox.checked = false;
                                const index = selectedOrder.indexOf(childCheckbox.value);
                                if (index > -1) selectedOrder.splice(index, 1);
                            });
                        }
                        updateSelectedOrder();
                    }
                
                    function handleCheckboxSelection(checkbox) {
                        if (checkbox.checked) {
                            if (!selectedOrder.includes(checkbox.value)) {
                                selectedOrder.push(checkbox.value);
                            }
                    
                            if (checkbox.value === 'no_arrange') {
                                document.getElementById('arrange-group-checkbox').checked = false;
                                document.getElementById('arrange-options').classList.add('hidden');
                                document.querySelectorAll('#arrange-options input[type="checkbox"]').forEach(childCheckbox => {
                                    if (childCheckbox.checked) {
                                        childCheckbox.checked = false;
                                        const index = selectedOrder.indexOf(childCheckbox.value);
                                        if (index > -1) selectedOrder.splice(index, 1);
                                    }
                                });
                            }
                        } else {
                            const index = selectedOrder.indexOf(checkbox.value);
                            if (index > -1) selectedOrder.splice(index, 1);
                        }
                        updateSelectedOrder();
                    }
                
                    function updateSelectedOrder() {
                        document.getElementById('selected_order_input').value = selectedOrder.join(',');
                    }
                </script>
                
                
                <!-- ‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Schedule -->
                <div class="sm:col-span-3">
                    <label for="schedule_file" class="block mb-2 text-sm font-medium text-gray-900">{{ form.schedule_file.label_tag }}</label>
                    <div class="mt-2">
                        {{ form.schedule_file|add_class:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" }}
                    </div>
                    <p class="mt-1 text-sm text-gray-500">Allowed formats: XLSM, XLSX.</p>

                    {% if form.schedule_file.errors %}
                        <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                            <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                            </svg>
                            <span class="sr-only">Info</span>
                            <div>
                                <span class="font-medium">Error:</span> 
                                {% for error in form.schedule_file.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                    </div>
                    {% endif %}
                </div>

                <!-- ‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Location -->
                <div class="sm:col-span-3">
                    <label for="location_file" class="block mb-2 text-sm font-medium text-gray-900">{{ form.location_file.label_tag }}</label>
                    <div class="mt-2">
                        {{ form.location_file|add_class:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" }}
                    </div>
                    <p class="mt-1 text-sm text-gray-500">Allowed formats: XLSM, XLSX.</p>
                    
                    {% if form.location_file.errors %}
                        <div class="flex items-center p-4 mt-2 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
                            <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                            </svg>
                            <span class="sr-only">Info</span>
                            <div>
                                <span class="font-medium">Error:</span> 
                                {% for error in form.location_file.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}
                </div>

                <!-- ‡∏õ‡∏∏‡πà‡∏° Submit -->
                <button id="uploadBtn" type="submit" name="upload_files" class="relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-cyan-500 to-blue-500 group-hover:from-cyan-500 group-hover:to-blue-500 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-cyan-200 dark:focus:ring-cyan-800">
                    <span class="relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0 inline-flex items-center">
                        ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå
                    </span>
                </button>
            </form>
        </div>

    {% else %}
    
        {% if error_messages %}
            <div class="flex p-4 mb-4 text-sm text-red-800 border border-red-300 rounded-lg shadow-md sm:text-xs md:text-sm lg:text-base xl:text-lg 2xl:text-xl bg-red-50 dark:bg-gray-800 dark:text-red-400 dark:border-red-600" role="alert">
                <svg class="flex-shrink-0 inline w-4 h-4 sm:w-4 sm:h-4 md:w-5 md:h-5 lg:w-6 lg:h-6 me-3 mt-[2px]" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                </svg>
                <span class="sr-only">Danger</span>
                <div class="flex-1">
                    <span class="text-base font-semibold sm:text-base md:text-lg lg:text-lg xl:text-lg 2xl:text-xl">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå:</span>
                    <ul class="mt-2 ml-4 space-y-1 text-sm list-disc list-inside sm:text-sm md:text-base lg:text-base xl:text-base 2xl:text-lg">
                        {% for message in error_messages %}
                            <li>{{ message }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}
        
        <div class="container relative px-6 pt-[1.375rem] pb-4 max-w-screen-sm mx-auto my-4 bg-white rounded-md shadow-sm">
            {% comment %} <div class="absolute top-0 left-0 w-full h-2 bg-[rgb(63,81,181)] rounded-t-md"></div> {% endcomment %}
        
            <h1 class="mb-4 text-3xl font-medium text-left text-gray-800">‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå</h1>
        
            <!-- Content Box ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î -->
            <div class="flex flex-col gap-3 px-6 pt-2 pb-3 mt-3 border-t border-gray-200">
                {% if request.session.schedule_filename %}
                
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-normal text-gray-700">
                            <strong class="text-base">Final Schedule File:</strong> {{ request.session.schedule_filename }}
                        </p>
                        <a href="{% url 'download_user_schedule' %}" class="flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 4v12m0 0l-3-3m3 3l3-3"/><path d="M5 20h14"/></svg>
                            DOWNLOAD
                        </a>
                    </div>

                {% endif %}
                {% if request.session.location_filename %}

                    <div class="flex items-center justify-between">
                        <p class="text-sm font-normal text-gray-700">
                            <strong class="text-base">Location File:</strong> {{ request.session.location_filename }}
                        </p>
                        <a href="{% url 'download_user_location' %}" class="flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 4v12m0 0l-3-3m3 3l3-3"/><path d="M5 20h14"/></svg>
                            DOWNLOAD
                        </a>
                    </div>

                {% endif %}
                
    {% endif %}
                
                {% if 'download_link_comment' in request.session %}
                
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-normal text-gray-700">
                            <strong class="text-base">Comment File:</strong> Comment.xlsx
                        </p>
                        <a href="{% url 'download_comment_file' %}" class="flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 4v12m0 0l-3-3m3 3l3-3"/><path d="M5 20h14"/></svg>
                            DOWNLOAD
                        </a>
                    </div>

                {% endif %}
                
            </div>
        </div>
    

    {% if 'download_link_comment' in request.session %}
    
    <div class="container relative max-w-screen-sm mx-auto my-4 overflow-x-auto bg-white rounded-lg shadow-sm sm:rounded-xl dark:bg-gray-800">    
        <table class="w-full text-sm text-left text-gray-700 dark:text-gray-300">
            <thead class="bg-gray-100 dark:bg-gray-700">
                <tr>
                    <th class="px-6 py-3 font-semibold text-gray-500 uppercase dark:text-gray-400">Data Preview Before Convert</th>
                    <th class="px-6 py-3 font-semibold text-gray-500 uppercase dark:text-gray-400">Value</th>
                </tr>
            </thead>
            <tbody>
                <!-- EGPROJECTID -->
                <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <th scope="row" class="px-6 py-4 font-medium text-gray-900 dark:text-white">
                        EGPROJECTID
                    </th>
                    <td class="px-6 py-4">
                        {{ request.session.egprojectid }}
                    </td>
                </tr>
                <!-- EGWBS (MMA WORK LIST) -->
                <tr class="border-b bg-gray-50 dark:bg-gray-700 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600">
                    <th scope="row" class="px-6 py-4 font-medium text-gray-900 dark:text-white">
                        EGWBS (MMA WORK LIST)
                    </th>
                    <td class="px-6 py-4">
                        {{ request.session.egwbs }}
                    </td>
                </tr>
                <!-- SITEID -->
                <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <th scope="row" class="px-6 py-4 font-medium text-gray-900 dark:text-white">
                        SITEID
                    </th>
                    <td class="px-6 py-4">
                        {{ request.session.siteid }}
                    </td>
                </tr>
                <!-- LOCATION(UNIT) -->
                <tr class="border-b bg-gray-50 dark:bg-gray-700 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600">
                    <th scope="row" class="px-6 py-4 font-medium text-gray-900 dark:text-white">
                        LOCATION (UNIT)
                    </th>
                    <td class="px-6 py-4">
                        {{ request.session.location }}
                    </td>
                </tr>
                <!-- WORKTYPE -->
                <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <th scope="row" class="px-6 py-4 font-medium text-gray-900 dark:text-white">
                        WORKTYPE
                    </th>
                    <td class="px-6 py-4">
                        {{ request.session.worktype }}
                    </td>
                </tr>
                <!-- EGMNTACTTYPE -->
                <tr class="border-b bg-gray-50 dark:bg-gray-700 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600">
                    <th scope="row" class="px-6 py-4 font-medium text-gray-900 dark:text-white">
                        EGMNTACTTYPE
                    </th>
                    <td class="px-6 py-4">
                        {{ request.session.egmntacttype }}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    
    {% endif %}

    {% if not error_messages %}

        {% if extracted_kks_counts is not None and extracted_kks_counts|length > 0 %}

            <div class="container relative px-6 pt-[1.375rem] pb-4 max-w-screen-sm mx-auto my-4 bg-white rounded-md shadow-sm">
                <form id="mappingForm" method="post" onsubmit="showLoading()">
                    {% csrf_token %}
                    <h1 class="mb-6 text-2xl font-semibold text-gray-800">‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î Plant Unit</h1>
                    <ul>
                        {% for kks_value, count in extracted_kks_counts.items %}
                            <input type="hidden" name="extracted_kks_counts[{{ kks_value }}]" value="{{ count }}">
                            
                            {% if user_input_mapping %}
                            
                                {% for key, value in user_input_mapping.items %}
                                    <div class="relative mb-4">
                                        <input type="text" id="disabled_{{ forloop.counter }}" class="block rounded-t-lg px-2.5 pb-2.5 pt-5 w-full text-sm text-gray-900 bg-gray-50 dark:bg-gray-700 border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " value="{{ value }}" disabled />
                                        <label for="disabled_{{ forloop.counter }}" class="absolute text-sm text-gray-400 dark:text-gray-500 duration-300 transform -translate-y-4 scale-75 top-4 z-10 origin-[0] start-2.5 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-4">
                                            {{ key }}
                                        </label>
                                    </div>
                                {% endfor %}
                                
                            {% else %}
                            
                            <div class="relative mb-4">
                                <input type="text" name="{{ kks_value }}" id="{{ kks_value }}" required 
                                        class="block rounded-t-lg px-2.5 pb-2.5 pt-5 w-full text-sm text-gray-900 bg-gray-50 dark:bg-gray-700 border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" 
                                        placeholder=" ">
                                <label for="{{ kks_value }}" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-4 z-10 origin-[0] start-2.5 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-4">
                                    {{ kks_value }} ({{ count }} times)
                                </label>
                            </div>
                            {% endif %}
                        {% endfor %}
                    </ul>
            
                    {% if not user_input_mapping %}

                    <button id="mappingBtn" name="kks_mapping_submit" value="submit" type="submit"
                    class="relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-cyan-500 to-blue-500 group-hover:from-cyan-500 group-hover:to-blue-500 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-cyan-200 dark:focus:ring-cyan-800 disabled:opacity-50 disabled:cursor-not-allowed">
                    <span class="relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0 inline-flex items-center">
                        ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
                    </span>
                </button>
                    {% endif %}
                </form>
            </div>

        {% endif %}

    {% endif %}
    
    <script>
        function showLoading() {
            const form = document.getElementById("mappingForm");
            const submitButton = document.getElementById('mappingBtn');

            if (form.checkValidity()){
                document.body.style.cursor = 'progress';
                //submitButton.disabled = true;
                submitButton.innerHTML = `
                    <span class="relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0 inline-flex items-center">
                        <svg aria-hidden="true" role="status" class="inline w-4 h-4 text-gray-200 me-3 animate-spin dark:text-gray-600" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/>
                            <path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="#1C64F2"/>
                        </svg>
                        Loading...
                    </span>
                `;
            }
        }
        document.addEventListener('DOMContentLoaded', function() {
            document.body.style.cursor = 'default'; // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥
        });
    </script>

    {% if 'download_link_job_plan_task' in request.session or 'download_link_job_plan_labor' in request.session or 'download_link_pm_plan' in request.session or 'download_link_template' in request.session %}
        <div class="container relative max-w-screen-sm mx-auto my-4 bg-[#f0ebf8] rounded-md shadow-sm">
            <details open class="mt-4 bg-white border border-gray-200 rounded">
                <summary class="flex items-center justify-between p-4 font-bold text-white bg-[rgb(63,81,181)] rounded-t">
                    <span class="text-lg">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</span>
                </summary>
                <div class="p-4 mt-3">
                    <ul class="space-y-4">
                        {% if 'download_link_job_plan_task' in request.session %}
                        <li class="flex items-center justify-between p-3 bg-white border rounded-lg shadow-sm">
                            <div class="flex items-center">
                                <img src="{% static 'icon/excel.svg' %}" alt="Excel icon" width="20" height="20" class="mr-2" />
                                <a href="{% url 'download_job_plan_task_file' %}" class="font-semibold text-blue-600 truncate hover:underline">
                                    ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Job Plan Task
                                </a>
                            </div>
                        </li>
                        {% endif %}
        
                        {% if 'download_link_job_plan_labor' in request.session %}
                        <li class="flex items-center justify-between p-3 bg-white border rounded-lg shadow-sm">
                            <div class="flex items-center">
                                <img src="{% static 'icon/excel.svg' %}" alt="Excel icon" width="20" height="20" class="mr-2" />
                                <a href="{% url 'download_job_plan_labor_file' %}" class="font-semibold text-blue-600 truncate hover:underline">
                                    ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Job Plan Labor
                                </a>
                            </div>
                        </li>
                        {% endif %}
        
                        {% if 'download_link_pm_plan' in request.session %}
                        <li class="flex items-center justify-between p-3 bg-white border rounded-lg shadow-sm">
                            <div class="flex items-center">
                                <img src="{% static 'icon/excel.svg' %}" alt="Excel icon" width="20" height="20" class="mr-2" />
                                <a href="{% url 'download_pm_plan_file' %}" class="font-semibold text-blue-600 truncate hover:underline">
                                    ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå PM Plan
                                </a>
                            </div>
                        </li>
                        {% endif %}
        
                        {% if 'download_link_template' in request.session %}
                        <li class="flex items-center justify-between p-3 bg-white border rounded-lg shadow-sm">
                            <div class="flex items-center">
                                <img src="{% static 'icon/excel.svg' %}" alt="Excel icon" width="20" height="20" class="mr-2" />
                                <a href="{% url 'download_template_file' %}" class="font-semibold text-blue-600 truncate hover:underline">
                                    ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Template MxLoader JB-PM Plan
                                </a>
                            </div>
                        </li>
                        {% endif %}
                    </ul>
                </div>
            </details>
        </div>
        
    {% endif %}
    
    <footer class="container relative max-w-screen-sm mx-auto my-4 bg-white rounded-lg shadow-sm dark:bg-gray-800">
        <div class="w-full max-w-screen-xl p-4 mx-auto md:flex md:items-center md:justify-between">
            <span class="text-sm text-gray-500 sm:text-center dark:text-gray-400">
                ‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏ú‡∏ô‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏á‡∏≤‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤ (‡∏´‡∏£‡∏ö-‡∏ü.) ‡∏Å‡∏≠‡∏á‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤ (‡∏Å‡∏ß‡∏ö-‡∏ü.) ‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ú‡∏•‡∏¥‡∏ï‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (‡∏≠‡∏´‡∏ü.) ‡πÇ‡∏ó‡∏£. 67341 , 67348
            </span>
        </div>
    </footer>

{% block script %}
    <!-- ‡∏ï‡∏Å‡πÄ‡πÄ‡∏ï‡πà‡∏á -->
    <script>
        function validateUploadForm(event) {
            event.preventDefault(); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

            let form = document.getElementById('uploadForm');
            let hasError = false;

            // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
            clearAllErrors();

            const yearField = document.getElementById('id_year');
            const frequencyField = document.getElementById('id_frequency');
            const plantTypeField = document.getElementById('id_plant_type');
            const siteField = document.getElementById('id_site');
            const childSiteField = document.getElementById('id_child_site');
            const unitField = document.getElementById('id_unit');
            const wostatusField = document.getElementById('id_wostatus');
            const workTypeField = document.getElementById('id_work_type');
            const acttypeField = document.getElementById('id_acttype');
            const wbsField = document.getElementById('id_wbs');
            const wbsOtherField = document.getElementById('other_wbs');
            const projectidOtherField = document.getElementById('other_projectid');
            const scheduleFileField = document.getElementById('id_schedule_file');
            const locationFileField = document.getElementById('id_location_file');
            const selectedOrderField = document.getElementById('selected_order_input');

            const fieldsToValidate = [
                { field: yearField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ ‡∏Ñ.‡∏®.' },
                { field: frequencyField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà' },
                { field: plantTypeField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤' },
                { field: siteField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡πÇ‡∏£‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤' },
                { field: childSiteField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤' },
                { field: unitField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î‡πÑ‡∏ü‡∏ü‡πâ‡∏≤' },
                { field: wostatusField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ö‡∏á‡∏≤‡∏ô' },
                { field: workTypeField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡πÉ‡∏ö‡∏á‡∏≤‡∏ô' },
                { field: acttypeField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏á‡∏≤‡∏ô' },
                { field: wbsField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å SUBWBS' },
                { field: scheduleFileField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Final Schedule' },
                { field: locationFileField, message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Location' }
            ];

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏ï‡πà‡∏≤‡∏á‡πÜ
            fieldsToValidate.forEach(({ field, message }) => {
                if (field.value === '') {
                    hasError = true;
                    showError(field.closest('.sm\\:col-span-3'), message);
                }
            });

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ü‡∏¥‡∏•‡∏î‡πå wbs ‡πÅ‡∏•‡∏∞ projectid "other"
            if (wbsField.value === '6') {
                if (wbsOtherField.value === '') {
                    hasError = true;
                    showError(wbsOtherField.closest('.sm\\:col-span-3'), '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏¥‡∏•‡∏î‡πå "Other WBS"');
                }
                if (projectidOtherField.value === '') {
                    hasError = true;
                    showError(projectidOtherField.closest('.sm\\:col-span-3'), '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏¥‡∏•‡∏î‡πå "Other PROJECTID"');
                }
            }

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö selected_order
            if (!selectedOrderField.value.trim()) {
                hasError = true;
                const container = document.getElementById('helper-checkbox-text').parentElement; // ‡πÉ‡∏ä‡πâ parentElement ‡πÅ‡∏ó‡∏ô closest()
                showError(container, '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Grouping ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å');
            }

            // ‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
            if (!hasError) {
                showUploadLoading(form);
            }
        }

        function showError(container, message) {
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (container.querySelector('.custom-alert')) {
                return; // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ return ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡πâ‡∏≥
            }

            const alertBox = document.createElement('div');
            alertBox.classList.add('custom-alert', 'flex', 'items-center', 'p-4', 'mt-2', 'text-sm', 'text-red-800', 'border', 'border-red-300', 'rounded-lg', 'bg-red-50');
            alertBox.setAttribute('role', 'alert');

            const messageText = document.createElement('span');
            messageText.textContent = message;
            alertBox.appendChild(messageText);

            container.appendChild(alertBox);
        }

        function clearAllErrors() {
            // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°
            document.querySelectorAll('.custom-alert').forEach(alert => alert.remove());
        }

        function showUploadLoading(form) {
            const button = document.getElementById('uploadBtn');
            document.body.style.cursor = 'progress';
            button.disabled = true;
            button.innerHTML = `
                <span class="relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0">
                    <svg aria-hidden="true" role="status" class="inline w-4 h-4 text-gray-200 me-3 animate-spin dark:text-gray-600" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/>
                        <path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="#1C64F2"/>
                    </svg>
                    Loading...
                </span>`;
            form.submit();
        }
        document.addEventListener('DOMContentLoaded', function() {
            document.body.style.cursor = 'default'; // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥
        });
    </script>


    <!-- AJAX for updating ACTTYPE -->
    <script>
        $(document).ready(function() {
            // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Plant Type
            $('#id_plant_type').change(function() {
                let plant_type_id = $(this).val(); // ‡∏î‡∏∂‡∏á plant_code ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å

                // ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô dropdown ‡∏Ç‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å server
                $('#id_acttype, #id_site, #id_child_site, #id_work_type, #id_unit').empty().append('<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>');
                $('#id_acttype, #id_site, #id_work_type, #id_unit').prop('disabled', true);
                $('#plant_type_description, #site_description, #child_site_description, #work_type_description, #acttype_description').text('');
                if (plant_type_id) {
                    // ‡∏™‡πà‡∏á AJAX request ‡πÑ‡∏õ‡∏ó‡∏µ‡πà server
                    $.ajax({
                        url: "{% url 'filter_plant_type' %}",
                        data: {'plant_type_id': plant_type_id},    // ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤ plant_code ‡πÑ‡∏õ‡∏¢‡∏±‡∏á backend
                        success: function (data) {
                            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ server ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                            if (data) {
                                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á plant_type
                                $('#plant_type_description').text(data.plant_type_th); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ plant_type
                                
                                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï dropdown ACTTYPE ‡πÇ‡∏î‡∏¢‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà
                                $('#id_acttype').empty().append('<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>');
                                $.each(data.acttypes, function (index, acttype) {
                                    $('#id_acttype').append('<option value="' + acttype.id + '">' + acttype.acttype + ' - ' + acttype.description + '</option>');
                                });
                                
                                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï dropdown SITE ‡πÇ‡∏î‡∏¢‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà
                                $('#id_site').empty().append('<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>');
                                $.each(data.sites, function (index, site) {
                                    $('#id_site').append('<option value="' + site.id + '">' + site.site_id + '</option>');
                                });
                                
                                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï dropdown WORKTYPE ‡πÇ‡∏î‡∏¢‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà
                                $('#id_work_type').empty().append('<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>');
                                $.each(data.work_types, function(index, worktype) {
                                    $('#id_work_type').append('<option value="' + worktype.id + '">' + worktype.worktype + ' - ' + worktype.description +'</option>');
                                });

                                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï dropdown UNIT
                                $('#id_unit').empty().append('<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>');
                                $.each(data.units, function(index, unit) {
                                    $('#id_unit').append('<option value="' + unit.id + '">' + unit.unit_code + '</option>');
                                });

                                // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô dropdown ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                                $('#id_acttype, #id_site, #id_work_type, #id_unit').prop('disabled', false);
                            }
                        },
                        error: function(xhr, status, error) {
                            $('#id_acttype, #id_site, #id_child_site, #id_work_type, #id_unit').empty().append('<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>');
                            $('#plant_type_description, #site_description, #child_site_description, #work_type_description, #acttype_description').text('');
                            alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å server: " + error);

                            // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô dropdown ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤ default
                            $('#id_acttype, #id_site, #id_work_type, #id_unit').prop('disabled', false);
                        }
                    });
                } else {
                    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Plant Type ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤ default
                    $('#id_acttype, #id_site, #id_child_site, #id_work_type, #id_unit').empty().append('<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>');
                    $('#plant_type_description, #site_description, #child_site_description, #work_type_description, #acttype_description').text('');
                    
                    // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô dropdown ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤ default
                    $('#id_acttype, #id_site, #id_work_type, #id_unit').prop('disabled', false);
                }
            });
        });
    </script>
    <script>
        $(document).ready(function() {
            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Site
            $('#id_site').change(function() {
                let site_id = $(this).val();  // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ site_id ‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å

                // ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô dropdown ‡∏Ç‡∏≠‡∏á Child Site ‡∏Ç‡∏ì‡∏∞‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å server
                $('#id_child_site').prop('disabled', true);

                if (site_id) {
                    $.ajax({
                        url: "{% url 'filter_site' %}",  // URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö view ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≠‡∏á SITE
                        data: {'site_id': site_id},  // ‡∏™‡πà‡∏á site_id ‡πÑ‡∏õ‡∏ó‡∏µ‡πà backend
                        dataType: 'json',  // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô JSON
                        success: function (data) {
                            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ChildSite ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                            if (data.child_sites.length > 0) {
                                // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô dropdown ‡∏Ç‡∏≠‡∏á ChildSite ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà
                                $('#id_child_site').empty().append('<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>');
                                $.each(data.child_sites, function(index, child_site) {
                                    $('#id_child_site').append('<option value="' + child_site.id + '">' + child_site.site_id + '</option>');
                                });
                            } else {
                                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ChildSite
                                $('#id_child_site').empty().append('<option value="">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Child Site</option>');
                            }

                            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ site_name
                            $('#site_description').text(data.site_name);  // ‡πÅ‡∏™‡∏î‡∏á site_name ‡πÉ‡∏ô HTML
                            // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô dropdown ‡∏Ç‡∏≠‡∏á Child Site ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à
                            $('#id_child_site').prop('disabled', false);
                        },
                        error: function(xhr, status, error) {
                            // ‡∏´‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏≤‡∏á dropdown ‡∏Ç‡∏≠‡∏á ChildSite ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                            $('#id_child_site').empty().append('<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>');
                            alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å server: " + error);
                            // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô dropdown ‡∏Ç‡∏≠‡∏á Child Site ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ
                            $('#id_child_site').prop('disabled', false);
                        }
                    });
                } else {
                    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Site ‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏≤‡∏á dropdown ‡∏Ç‡∏≠‡∏á ChildSite ‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ Site
                    $('#id_child_site').empty().append('<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>');
                    $('#site_description').text('');
                    $('#child_site_description').text('');
                    $('#id_child_site').prop('disabled', false);  // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô dropdown ‡∏Ç‡∏≠‡∏á ChildSite
                }
            });

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Child Site
            $('#id_child_site').change(function() {
                let child_site_id = $(this).val();  // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ child_site_id ‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å

                if (child_site_id) {
                    // ‡∏™‡πà‡∏á AJAX request ‡πÑ‡∏õ‡∏ó‡∏µ‡πà server ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á Child Site
                    $.ajax({
                        url: "{% url 'filter_child_site' %}",  // URL ‡πÑ‡∏õ‡∏¢‡∏±‡∏á view ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á Child Site
                        data: {'child_site_id': child_site_id},  // ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤ child_site_id ‡πÑ‡∏õ‡∏¢‡∏±‡∏á backend
                        dataType: 'json',  // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô JSON
                        success: function(data) {
                            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á Child Site
                            $('#child_site_description').text(data.description);  // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÉ‡∏ô #child_site_description
                        },
                        error: function(xhr, status, error) {
                            // ‡∏´‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢
                            $('#child_site_description').text('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÑ‡∏î‡πâ');
                            alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å server: " + error);
                        }
                    });
                } else {
                    // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Child Site
                    $('#child_site_description').text('');
                }
            });
        });
    </script>
    <script>
        $(document).ready(function() {

            $('#id_work_type').change(function() {
                let work_type_id = $(this).val();
            
                if(work_type_id){
                    $.ajax({
                        url: "{% url 'filter_worktype' %}",
                        data: {'work_type_id': work_type_id},
                        success: function (data){
                            $('#work_type_description').text(data.description);
                        }
                    });
                } else {
                    $('#work_type_description').text('');
                }
            });
        });
    </script>
    <script>
        $(document).ready(function() {
            $('#id_acttype').change(function() {
                let acttype_id = $(this).val();

                if (acttype_id){
                    $.ajax({
                        url: "{% url 'filter_acttype' %}",
                        data: {'acttype_id': acttype_id},
                        success: function (data) {
                            $('#acttype_description').text(data.description + ' (' + data.code + ')');
                        }
                    });
                } else {
                    $('#acttype_description').text('');
                }
            });
        });
    </script>
    <script>
        $(document).ready(function() {
            $('#id_wbs').change(function() {
                let wbs_id = $(this).val();
                
                if (wbs_id){
                    $.ajax({
                        url: "{% url 'filter_wbs' %}",
                        data: {'wbs_id': wbs_id},
                        success: function (data) {
                            $('#wbs_description').text(data.description);
                        }
                    });
                } else {
                    $('#wbs_description').text('');
                }
            });
        });
    </script>
    <script>
        $(document).ready(function() {
            $('#id_wostatus').change(function() {
                let wostatus_id = $(this).val();
            
                if (wostatus_id) {
                    $.ajax({
                        url: "{% url 'filter_wostatus' %}",
                        data: {'wostatus_id': wostatus_id},
                        success: function (data) {
                            $('#wostatus_description').text(data.description);
                        }
                    });
                } else {
                    $('#wostatus_description').text('');
                }
            });
        });
    </script>
{% endblock %}
{% endblock content %}